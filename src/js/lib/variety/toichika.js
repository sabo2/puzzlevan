/*! @license pzpr.js v3.5.2-pre (c) 2009-2015 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.classmgr.makeCustom(["toichika"],{MouseEvent:{mouseinput:function(){this.owner.playmode?this.mousestart||this.mousemove?this.btn.Left?this.inputarrow_cell():this.btn.Right&&this.inputDot():this.mouseend&&this.notInputted()&&this.inputqnum():this.owner.editmode&&(this.mousestart||this.mousemove?this.isBorderMode()?this.inputborder():this.inputarrow_cell():this.mouseend&&this.notInputted()&&this.inputqnum())},inputDot:function(){var a=this.getcell();a.isnull||a===this.mouseCell||-1!==a.qnum||(null===this.inputData&&(this.inputData=1===a.qsub?0:1),a.setAnum(-1),a.setQsub(1===this.inputData?1:0),this.mouseCell=a,a.draw())}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(a){return a.match(/shift/)?!1:this.moveTCell(a)},keyinput:function(a){this.key_toichika(a)},key_toichika:function(a){"1"===a||"w"===a||"shift+up"===a?a="1":"2"===a||"s"===a||"shift+right"===a?a="4":"3"===a||"z"===a||"shift+down"===a?a="2":"4"===a||"a"===a||"shift+left"===a?a="3":"5"===a||"q"===a||"-"===a?a="s1":("6"===a||"e"===a||" "===a)&&(a=" "),this.key_inputqnum(a)}},Cell:{numberAsObject:!0,maxnum:4},Board:{hasborder:1,getPairedArrowsInfo:function(){for(var a=[],b=[],c=0;c<this.cellmax;c++)b[c]=this.cell[c].isNum();for(var c=0;c<this.cellmax;c++){var d=this.cell[c];if(!d.noNum())for(var e=d.getaddr(),f=d.getNum();;){e.movedir(f,2);var g=e.getc();if(g.isnull){a.push([d.id]);break}if(b[g.id]){a.push(g.getNum()!==[0,g.DN,g.UP,g.RT,g.LT][f]?[d.id]:[g.id,d.id]);break}}}return a}},BoardExec:{adjustBoardData:function(a,b){this.adjustCellArrow(a,b)}},AreaRoomManager:{enabled:!0},Graphic:{gridcolor_type:"LIGHT",dotcolor_type:"PINK",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawBorders(),this.drawDotCells(!0),this.drawCellArrows(),this.drawHatenas(),this.drawChassis(),this.drawCursor()}},Encode:{decodePzpr:function(){this.decodeBorder(),this.decode4Cell_toichika()},encodePzpr:function(){this.encodeBorder(),this.encode4Cell_toichika()},decode4Cell_toichika:function(){var a=0,b=0,c=this.outbstr,d=this.owner.board;for(b=0;b<c.length;b++){var e=d.cell[a],f=c.charAt(b);if(this.include(f,"1","4")?e.qnum=parseInt(c.substr(b,1),10):"."===f?e.qnum=-2:a+=parseInt(f,36)-5,a++,a>=d.cellmax)break}this.outbstr=c.substr(b)},encode4Cell_toichika:function(){for(var a="",b=0,c=this.owner.board,d=0;d<c.cellmax;d++){var e="",f=c.cell[d].qnum;-2===f?e=".":f>=1&&4>=f?e=f.toString(10):b++,0===b?a+=e:(e||31===b)&&(a+=(4+b).toString(36)+e,b=0)}b>0&&(a+=(4+b).toString(36)),this.outbstr+=a}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAnumsub()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkDoubleNumber","checkAdjacentCountries","checkDirectionOfArrow","checkNoNumber"],getPairArrowInfo:function(){return this._info.parrow=this._info.parrow||this.owner.board.getPairedArrowsInfo()},checkDirectionOfArrow:function(){for(var a=this.getPairArrowInfo(),b=0;b<a.length;b++)if(1===a[b].length){if(this.failcode.add("arAlone"),this.checkOnly)break;this.owner.board.cell[a[b]].seterr(1)}},checkAdjacentCountries:function(){for(var a=this.getRoomInfo(),b=this.getPairArrowInfo(),c=a.getSideAreaInfo(),d=[],e=1;e<=a.max-1;e++){d[e]=[];for(var f=0;f<c[e].length;f++)d[e][c[e][f]]=!0;for(var g=e+1;g<=a.max;g++)d[e][g]||(d[e][g]=!1)}for(var f=0;f<b.length;f++)if(1!==b[f].length){var h=a.id[b[f][0]],i=a.id[b[f][1]];if(!((i>h?d[h][i]:d[i][h])<=0)){if(this.failcode.add("arAdjPair"),this.checkOnly)break;a.area[h].clist.seterr(1),a.area[i].clist.seterr(1)}}}},FailCode:{bkNoNum:["国に矢印が入っていません。","A country has no arrow."],bkNumGe2:["1つの国に2つ以上の矢印が入っています。","A country has plural arrows."],arAdjPair:["辺を共有する国にペアとなる矢印が入っています。","There are paired arrows in adjacent countries."],arAlone:["矢印の先にペアとなる矢印がいません。","There is not paired arrow in the direction of an arrow."]}});