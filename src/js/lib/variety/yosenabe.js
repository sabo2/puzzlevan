/*! @license pzpr.js v3.5.2 (c) 2009-2015 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.classmgr.makeCustom(["yosenabe"],{MouseEvent:{mouseinput:function(){this.owner.playmode?this.mousestart||this.mousemove?this.btn.Left?this.inputMoveLine():this.btn.Right&&this.inputpeke():this.mouseend&&this.notInputted()&&this.inputdark():this.owner.editmode&&(this.mousestart||this.mousemove?this.btn.Right&&this.inputNabe():this.mouseend&&this.notInputted()&&this.inputqnum_yosenabe())},inputdark:function(){var a=this.getcell();if(!a.isnull){var b=this.owner.execConfig("dispmove")?a.base:a,c=.6,d=this.inputPoint.bx-a.bx,e=this.inputPoint.by-a.by;c*c>d*d+e*e&&(b.setQcmp(0===b.qcmp?1:0),b.draw())}},inputNabe:function(){var a=this.getcell();if(!a.isnull&&a!==this.mouseCell){if(a.isNum())return void this.inputqnum();if(-1!==a.qnum2)return void this.inputqnum_yosenabe();null===this.inputData&&(this.inputData=a.ice()?0:6),a.setQues(this.inputData),a.drawaround(),this.mouseCell=a}},inputqnum_yosenabe:function(){var a=this.getcell();a.isnull||a===this.mouseCell||(a!==this.cursor.getc()?this.setcursor(a):this.inputnumber_yosenabe(a),this.mouseCell=a)},inputnumber_yosenabe:function(a){var b,c,d=a.getmaxnum(),e=-1;-1!==a.qnum?(b=a.qnum,c=1):-1!==a.qnum2?(b=a.qnum2,c=2):(b=-1,c=a.ice()?2:1),this.btn.Left?e=b===d?-1:-1===b?-2:-2===b?1:b+1:this.btn.Right&&(e=-1===b?d:-2===b?-1:1===b?-2:b-1),1===c?a.setQnum(e):2===c&&a.setQnum2(e),a.draw()}},KeyEvent:{enablemake:!0,keyinput:function(a){this.key_inputqnum_yosenabe(a)},key_inputqnum_yosenabe:function(a){var b,c=this.cursor.getc();if("q"===a||"q1"===a||"q2"===a)"q"===a&&(a=-1!==c.qnum?"q1":"q2"),"q1"===a&&-1!==c.qnum?(c.setQnum2(c.qnum),c.setQnum(-1)):"q2"===a&&-1!==c.qnum2&&(c.setQnum(c.qnum2),c.setQnum2(-1));else if("w"===a)c.setQues(c.ice()?0:6);else{var d,e=c.getmaxnum(),f=-1,g=-1;if(-1!==c.qnum?(g=c.qnum,d=1):-1!==c.qnum2?(g=c.qnum2,d=2):(g=-1,d=c.ice()?2:1),a>="0"&&"9">=a){var b=+a;if((0>=g||10*g+b>e||this.prev!==c)&&(g=0),f=10*g+b,f>e)return}else if("BS"===a)f=0>g?-1:10>g?-2:g/10|0;else if("-"===a)f=-2!==g?-2:-1;else{if(" "!==a)return;f=-1}1===d?c.setQnum(f):2===d&&c.setQnum2(f)}this.prev=c,c.draw()}},Cell:{isCmp:function(){return 1===(this.owner.execConfig("dispmove")?this.base:this).qcmp}},CellList:{getDeparture:function(){return this.map(function(a){return a.base}).notnull()},getSumOfFilling:function(){for(var a=0,b=0,c=this.length;c>b;b++)this[b].base.isValidNum()&&(a+=this[b].base.qnum);return a}},Board:{qcols:8,qrows:8,hasborder:1,initialize:function(){this.common.initialize.call(this),this.iceinfo=this.addInfoList(this.owner.AreaCrockManager)}},LineManager:{isCenterLine:!0},AreaLineManager:{enabled:!0,moveline:!0},"AreaCrockManager:AreaManager":{enabled:!0,relation:["cell"],isvalid:function(a){return a.ice()}},Graphic:{hideHatena:!0,gridcolor_type:"LIGHT",globalfontsizeratio:.85,bgcellcolor_func:"icebarn",bordercolor_func:"ice",icecolor:"rgb(224,224,224)",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawBorders(),this.drawTip(),this.drawDepartures(),this.drawLines(),this.drawCircles(),this.drawNumbers(),this.drawFillingNumBase(),this.drawFillingNumbers(),this.drawPekes(),this.drawChassis(),this.drawTarget()},getCircleFillColor:function(a){var b=this.owner,c=a.error||a.qinfo,d=b.execConfig("dispmove"),e=(d?a.base:a).qnum;return-1!==e?1===c||4===c?this.errbcolor1:a.isCmp()?this.qcmpcolor:this.circledcolor:null},drawFillingNumBase:function(){for(var a=this.vinc("cell_filling_back","crispEdges",!0),b=this.owner.execConfig("dispmove"),c=this.range.cells,d=0;d<c.length;d++){var e=c[d],f=this.getBGCellColor(e);if(a.vid="c_full_nb_"+e.id,f&&-1!==e.qnum2&&b&&e.isDestination()){var g=(e.bx-.9)*this.bw-.5,h=(e.by-.9)*this.bh-.5;a.fillStyle=f,a.fillRect(g,h,.8*this.bw,.8*this.bh)}else a.vhide()}},drawFillingNumbers:function(){for(var a=this.vinc("cell_filling_number","auto"),b=this.owner.execConfig("dispmove"),c=this.range.cells,d=0;d<c.length;d++){var e=c[d],f=e.qnum2,g=e.bx*this.bw,h=e.by*this.bh;if(a.vid="cell_fill_text_"+e.id,-1!==f){var i=f>0?""+f:"?",j={style:"bold"};b&&e.isDestination()?(j.position=this.TOPLEFT,j.globalratio=.5):j.globalratio=.8,a.fillStyle=this.getCellNumberColor(e),this.disptext(i,g,h,j)}else a.vhide()}}},Encode:{decodePzpr:function(){this.decodeIce(),this.decodeNumber16_yosenabe()},encodePzpr:function(){this.encodeIce(),this.encodeNumber16_yosenabe()},decodeNumber16_yosenabe:function(){var a=0,b=0,c=this.outbstr,d=this.owner.board;for(b=0;b<c.length;b++){var e=d.cell[a],f=c.charAt(b);if(this.include(f,"0","9")||this.include(f,"a","f")?e.qnum=parseInt(f,16):"-"===f?(e.qnum=parseInt(c.substr(b+1,2),16),b+=2):"."===f?e.qnum=-2:"i"===f?(e.qnum2=parseInt(c.substr(b+1,1),16),b+=1):"g"===f?(e.qnum2=parseInt(c.substr(b+1,2),16),b+=2):"h"===f?e.qnum2=-2:f>="j"&&"z">=f&&(a+=parseInt(f,36)-19),a++,a>=d.cellmax)break}this.outbstr=c.substr(b+1)},encodeNumber16_yosenabe:function(){for(var a=0,b="",c=this.owner.board,d=0;d<c.cellmax;d++){var e="",f=c.cell[d].qnum,g=c.cell[d].qnum2;-2===f?e=".":f>=0&&16>f?e=f.toString(16):f>=16&&256>f?e="-"+f.toString(16):-2===g?e="h":g>=0&&16>g?e="i"+g.toString(16):g>=16&&256>g?e="g"+g.toString(16):a++,0===a?b+=e:(e||17===a)&&(b+=(18+a).toString(36)+e,a=0)}a>0&&(b+=(18+a).toString(36)),this.outbstr+=b}},FileIO:{decodeData:function(){this.decodeCell(function(a,b){"i"===b.charAt(0)&&(a.ques=6,b=b.substr(1)),"o"===b.charAt(0)?(b=b.substr(1),a.qnum=b?+b:-2):b&&"."!==b&&(a.qnum2=+b)}),this.decodeBorderLine(),this.filever>=1&&this.decodeCellQsubQcmp()},encodeData:function(){this.filever=1,this.encodeCell(function(a){var b="";return 6===a.ques&&(b+="i"),-1!==a.qnum?(b+="o",a.qnum>=0&&(b+=""+a.qnum)):a.qnum2>0&&(b+=""+a.qnum2),(b?b:".")+" "}),this.encodeBorderLine(),this.encodeCellQsubQcmp()},decodeCellQsubQcmp:function(){this.decodeCell(function(a,b){"0"!==b&&(a.qsub=15&+b,a.qcmp=+b>>4)})},encodeCellQsubQcmp:function(){this.encodeCell(function(a){return a.qsub+(a.qcmp<<4)+" "})}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine","checkConnectObject","checkLineOverLetter","checkCurveLine","checkQuesNumber","checkDoubleNumberInNabe","checkFillingCount","checkNoFillingNabe","checkFillingOutOfNabe","checkDisconnectLine"],getNabeInfo:function(){return this._info.nabe=this._info.nabe||this.owner.board.iceinfo.getAreaInfo()},checkCurveLine:function(){this.checkAllArea(this.getLareaInfo(),function(a,b){return 1===a||1===b},"laCurve")},checkQuesNumber:function(){this.checkAllCell(function(a){return!a.ice()&&-1!==a.qnum2},"bnIllegalPos")},checkDoubleNumberInNabe:function(){var a=this.getNabeInfo();this.checkAllBlock(a,function(a){return-1!==a.qnum2},function(a,b,c){return 2>c},"bkDoubleBn")},checkNoFillingNabe:function(){this.checkNoMovedObjectInRoom(this.getNabeInfo())},checkFillingOutOfNabe:function(){this.checkAllCell(function(a){return a.isDestination()&&!a.ice()},"nmOutOfBk")},checkFillingCount:function(){for(var a=this.getNabeInfo(),b=1;b<=a.max;b++){for(var c=a.area[b].clist,d=null,e=0;e<c.length;e++){var f=c[e].qnum2;if(-1!==f){if(null!==d&&d!==f){d=null;break}d=f}}if(null!==d){var g=c.getSumOfFilling();if(0!==g&&d!==g){if(this.failcode.add("bkSumNeBn"),this.checkOnly)break;c.getDeparture().seterr(4),c.seterr(1)}}}}},FailCode:{laOnNum:["具材の上を線が通過しています。","A line goes through a filling."],laIsolate:["具材につながっていない線があります。","A line doesn't connect any filling."],nmConnected:["具材が繋がっています。","There are connected fillings."],nmOutOfBk:["鍋に入っていない具材があります。","A filling isn't in a crock."],bnIllegalPos:["鍋の外に数字が書いてあります。","There is a number out of a crock."],bkDoubleBn:["鍋に数字が２つ以上書いてあります。","There is two or more numbers in a crock."],bkSumNeBn:["具材の合計値が正しくありません。","Sum of filling is not equal to a crock."],bkNoNum:["具材のない鍋があります。","A crock has no circle."]}});