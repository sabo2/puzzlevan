/*! @license pzpr.js v3.5.2-pre (c) 2009-2015 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.classmgr.makeCustom(["heyawake","ayeheya"],{MouseEvent:{RBShadeCell:!0,mouseinput:function(){this.owner.playmode?(this.mousestart||this.mousemove)&&this.inputcell():this.owner.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())}},KeyEvent:{enablemake:!0},Cell:{maxnum:function(){var a=this.owner.board.rooms.getClistByCell(this).getRectSize(),b=a.cols,c=a.rows;if(b>c){var d=b;b=c,c=d}return 1===b?c+1>>1:2===b?c:3===b?c%4===0?c/4*5:c%4===1?(c-1)/4*5+2:c%4===2?(c-2)/4*5+3:(c+1)/4*5:Math.log(b+1)/Math.log(2)%1===0&&b===c?(b*c+b+c)/3:1&b&&1&c?(b*c+b+c-1)/3|0:(b*c+b+c-2)/3|0},minnum:0},Board:{hasborder:1},AreaUnshadeManager:{enabled:!0},AreaRoomManager:{enabled:!0,hastop:!0},Flags:{use:!0,redblk:!0},Graphic:{gridcolor_type:"LIGHT",bcolor_type:"GREEN",bgcellcolor_func:"qsub1",bbcolor:"rgb(160, 255, 191)",paint:function(){this.drawBGCells(),this.drawGrid(),this.drawShadedCells(),this.drawNumbers(),this.drawBorders(),this.drawChassis(),this.drawBoxBorders(!1),this.drawTarget()}},Encode:{decodePzpr:function(){this.decodeBorder(),this.decodeRoomNumber16()},encodePzpr:function(){this.encodeBorder(),this.encodeRoomNumber16()},decodeKanpen:function(){this.owner.fio.decodeSquareRoom()},encodeKanpen:function(){this.owner.fio.encodeSquareRoom()},decodeHeyaApp:function(){for(var a=0,b=[],c=this.owner.board,a=0;a<c.cellmax;a++)b[a]=null;for(var d=0,e=this.outbstr.split("/"),a=0;a<c.cellmax;a++)if(null===b[a]){var f=c.cell[a];if(e[d].match(/(\d+in)?(\d+)x(\d+)$/)){RegExp.$1.length>0&&(f.qnum=parseInt(RegExp.$1));var g=f.bx,h=g+2*parseInt(RegExp.$2)-2,i=f.by,j=i+2*parseInt(RegExp.$3)-2;this.owner.fio.setRdataRect(b,d,{x1:g,x2:h,y1:i,y2:j})}d++}this.owner.fio.rdata2Border(!0,b)},encodeHeyaApp:function(){for(var a=[],b=this.owner.board,c=b.getRoomInfo(),d=1;d<=c.max;d++){var e=c.area[d].clist.getRectSize(),f=b.getc(e.x1,e.y1).qnum;a.push((f>=0?""+f+"in":"")+e.cols+"x"+e.rows)}this.outbstr=a.join("/")}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum(),this.decodeCellAns()},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum(),this.encodeCellAns()},kanpenOpen:function(){this.decodeSquareRoom(),this.decodeCellAns()},kanpenSave:function(){this.encodeSquareRoom(),this.encodeCellAns()}},AnsCheck:{checklist:["checkAdjacentShadeCell","checkConnectUnshadeRB","checkFractal@ayeheya","checkShadeCellCount","checkCountinuousUnshadeCell","checkRoomRect"],checkFractal:function(){var a=this.getRoomInfo();a:for(var b=1;b<=a.max;b++)for(var c=a.area[b].clist,d=c.getRectSize(),e=d.x1+d.x2,f=d.y1+d.y2,g=0;g<c.length;g++){var h=c[g],i=this.owner.board.getc(e-h.bx,f-h.by);if(h.isShade()!==i.isShade()){if(this.failcode.add("bkNotSymShade"),this.checkOnly)break a;c.seterr(1)}}},checkCountinuousUnshadeCell:function(){var a=this.checkOnly;this.checkOnly=!0,this.checkRowsColsPartly(this.isBorderCount,function(a){return a.isShade()},"bkUnshadeConsecGt3"),this.checkOnly=a},isBorderCount:function(a){var b,c,d=a.getRectSize(),e=0,f=this.owner.board;if(d.x1===d.x2)for(b=d.x1,c=d.y1+1;c<=d.y2-1;c+=2)f.getb(b,c).isBorder()&&e++;else if(d.y1===d.y2)for(c=d.y1,b=d.x1+1;b<=d.x2-1;b+=2)f.getb(b,c).isBorder()&&e++;var g=1>=e;return g||a.seterr(1),g}},FailCode:{bkUnshadeConsecGt3:["白マスが3部屋連続で続いています。","Unshaded cells are continued for three consecutive room."],bkNotSymShade:["部屋の中の黒マスが点対称に配置されていません。","Position of shaded cells in the room is not point symmetric."]}});