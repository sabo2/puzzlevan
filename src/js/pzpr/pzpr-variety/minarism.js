/*! @license pzpr.js v0.3.2 (c) 2009-2016 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
!function(a,b){"object"==typeof module&&module.exports?module.exports=[a,b]:pzpr.classmgr.makeCustom(a,b)}(["minarism"],{MouseEvent:{mouseinput:function(){this.puzzle.playmode?this.mousestart&&this.inputqnum():this.puzzle.editmode&&(this.mousestart||this.mousemove?"left"===this.btn&&this.inputmark_mousemove():this.mouseend&&this.notInputted()&&this.inputmark_mouseup())},inputmark_mousemove:function(){var a=this.getpos(0);if(!a.getc().isnull){var b=this.prevPos.getnb(a);return b.isnull?void(this.prevPos=a):(this.inputData=this.prevPos.getdir(a,2),b.setQdir(this.inputData!==b.qdir?this.inputData:0),b.draw(),void this.mousereset())}},inputmark_mouseup:function(){var a=this.getpos(.33);if(a.isinside())if(this.cursor.equals(a)){var b=a.getb();if(b.isnull)return;var c=b.qnum,d=b.qdir,e=b.isHorz()?0:2,f=Math.max(this.board.cols,this.board.rows)-1;"left"===this.btn?-1===c&&0===d?(b.setQnum(-1),b.setQdir(e+1)):-1===c&&d===e+1?(b.setQnum(-1),b.setQdir(e+2)):-1===c&&d===e+2?(b.setQnum(1),b.setQdir(0)):c===f?(b.setQnum(-2),b.setQdir(0)):-2===c?(b.setQnum(-1),b.setQdir(0)):b.setQnum(c+1):"right"===this.btn&&(-1===c&&0===d?(b.setQnum(-2),b.setQdir(0)):-2===c?(b.setQnum(f),b.setQdir(0)):1===c&&0===d?(b.setQnum(-1),b.setQdir(e+2)):-1===c&&d===e+2?(b.setQnum(-1),b.setQdir(e+1)):-1===c&&d===e+1?(b.setQnum(-1),b.setQdir(0)):b.setQnum(c-1)),b.draw()}else this.setcursor(a),a.draw()}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(a){return this.puzzle.editmode?this.moveTBorder(a):this.puzzle.playmode?this.moveTCell(a):!1},keyinput:function(a){this.puzzle.editmode?this.key_inputmark(a):this.puzzle.playmode&&this.key_inputqnum(a)},key_inputmark:function(a){var b=this.cursor.getb();if(!b.isnull){if("q"===a||"w"===a||"e"===a||" "===a||"-"===a){var c=b.NDIR;"q"===a&&(c=b.isHorz()?b.UP:b.LT),"w"===a&&(c=b.isHorz()?b.DN:b.RT),b.setQdir(b.qdir!==c?c:b.NDIR),b.setQnum(-1)}else{if(!(a>="0"&&"9">=a))return;var d=+a,e=b.qnum,f=Math.max(this.board.cols,this.board.rows)-1;b.setQdir(b.NDIR),0>=e||this.prev!==b?f>=d&&b.setQnum(d):f>=10*e+d?b.setQnum(10*e+d):f>=d&&b.setQnum(d)}this.prev=b,b.draw()}}},TargetCursor:{adjust_modechange:function(){this.bx-=(this.bx+1)%2,this.by-=(this.by+1)%2}},Cell:{maxnum:function(){return Math.max(this.board.cols,this.board.rows)}},Board:{cols:7,rows:7,hasborder:1},BoardExec:{adjustBoardData:function(a,b){this.adjustBorderArrow(a,b)}},Graphic:{hideHatena:!0,gridcolor_type:"LIGHT",numbercolor_func:"anum",paint:function(){this.drawBDBase(),this.drawBGCells(),this.drawDashedGrid(),this.drawBDNumbers_and_IneqSigns(),this.drawNumbers(),this.drawChassis(),this.drawTarget_minarism()},drawBDBase:function(){var a=this.vinc("border_base","auto");if(a.use.canvas)for(var b=.29*this.cw,c=this.range.borders,d=0;d<c.length;d++){var e=c[d];if(0!==e.qdir||-1!==e.qnum){var f=e.bx*this.bw,g=e.by*this.bh;a.fillStyle="white",a.fillRectCenter(f,g,b,b)}}},drawBDNumbers_and_IneqSigns:function(){var a=this.vinc("border_marks","auto",!0),b=.27*this.cw,c=.22*this.cw;a.lineWidth=1,a.strokeStyle=this.quescolor;for(var d={ratio:[.45]},e=this.range.borders,f=0;f<e.length;f++){var g=e[f],h=g.bx*this.bw,i=g.by*this.bh;if(a.vid="b_cp_"+g.id,-1!==g.qnum?(a.fillStyle=1===g.error?this.errcolor1:"white",a.shapeCircle(h,i,b)):a.vhide(),a.vid="border_text_"+g.id,g.qnum>0?(a.fillStyle=this.fontcolor,this.disptext(""+g.qnum,h,i,d)):a.vhide(),a.vid="b_is1_"+g.id,g.qdir===g.UP||g.qdir===g.LT){switch(a.beginPath(),g.qdir){case g.UP:a.setOffsetLinePath(h,i,-c,+c,0,-c,+c,+c,!1);break;case g.LT:a.setOffsetLinePath(h,i,+c,-c,-c,0,+c,+c,!1)}a.stroke()}else a.vhide();if(a.vid="b_is2_"+g.id,g.qdir===g.DN||g.qdir===g.RT){switch(a.beginPath(),g.qdir){case g.DN:a.setOffsetLinePath(h,i,-c,-c,0,+c,+c,-c,!1);break;case g.RT:a.setOffsetLinePath(h,i,-c,-c,+c,0,-c,+c,!1)}a.stroke()}else a.vhide()}},drawTarget_minarism:function(){this.drawCursor(this.puzzle.playmode)}},Encode:{decodePzpr:function(a){this.decodeMinarism(a)},encodePzpr:function(a){this.encodeMinarism(a)},decodeMinarism:function(a){var b=this.puzzle.pzpr.parser,c=0,d=0,e=0,f=this.outbstr,g=this.board,h=g.border.length;a===b.URL_PZPRAPP&&(h+=g.cols+g.rows);for(var i=0;i<f.length;i++){var j=f.charAt(i);a===b.URL_PZPRAPP&&(c<g.cols*g.rows?e=c/g.cols|0:c<2*g.cols*g.rows&&(e=g.rows));var k=g.border[c-e],l=0;if(this.include(j,"0","9")||this.include(j,"a","f")?k.qnum=parseInt(j,16):"-"===j?(k.qnum=parseInt(f.substr(i+1,2),16),i+=2):"."===j?k.qnum=-2:"g"===j?l=a===b.URL_PZPRV3||c<g.cols*g.rows?1:2:"h"===j?l=a===b.URL_PZPRV3||c<g.cols*g.rows?2:1:this.include(j,"i","z")?c+=parseInt(j,36)-18:a===b.URL_PZPRAPP&&"/"===j&&(c=g.cell.length-1),1===l?k.qdir=k.isHorz()?k.UP:k.LT:2===l&&(k.qdir=k.isHorz()?k.DN:k.RT),c++,c>=h){d=i+1;break}}this.outbstr=f.substr(d)},encodeMinarism:function(a){for(var b=this.puzzle.pzpr.parser,c="",d=0,e=this.board,f=0;f<e.border.length;f++){var g="",h=e.border[f];if(h){var i=h.qdir,j=h.qnum;i===h.UP||i===h.LT?g=a===b.URL_PZPRV3||e.cell[f]?"g":"h":i===h.DN||i===h.RT?g=a===b.URL_PZPRV3||e.cell[f]?"h":"g":-2===j?g=".":j>=0&&16>j?g=""+j.toString(16):j>=16&&256>j?g="-"+j.toString(16):d++}else d++;0===d?c+=g:(g||18===d)&&(c+=(17+d).toString(36)+g,d=0)}d>0&&(c+=(17+d).toString(36)),this.outbstr+=c}},FileIO:{decodeData:function(){this.decodeBorder(function(a,b){"a"===b?a.qdir=a.isHorz()?a.UP:a.LT:"b"===b?a.qdir=a.isHorz()?a.DN:a.RT:"."===b?a.qnum=-2:"0"!==b&&(a.qnum=+b)}),this.decodeCellAnumsub()},encodeData:function(){this.encodeBorder(function(a){var b=a.qdir;return b===a.UP||b===a.LT?"a ":b===a.DN||b===a.RT?"b ":-2===a.qnum?". ":-1!==a.qnum?a.qnum+" ":"0 "}),this.encodeCellAnumsub()}},AnsCheck:{checklist:["checkDifferentNumberInLine","checkSubOfNumber","checkIneqMark","checkNoNumCell+"],checkDifferentNumberInLine:function(){this.checkRowsCols(this.isDifferentNumberInClist,"nmDupRow")},checkSubOfNumber:function(){this.checkHintSideCell(function(a,b,c){return a.qnum>0&&a.qnum!==Math.abs(b-c)},"nmSubNe")},checkIneqMark:function(){this.checkHintSideCell(function(a,b,c){var d=a.qdir;return!(0===d||(1===d||3===d)&&c>b||(2===d||4===d)&&b>c)},"nmIneqNe")},checkHintSideCell:function(a,b){for(var c=this.board.border,d=0;d<c.length;d++){var e=c[d],f=e.sidecell[0],g=e.sidecell[1],h=f.getNum(),i=g.getNum();if(!(0>=h||0>=i)&&a(e,h,i)){if(this.failcode.add(b),this.checkOnly)break;f.seterr(1),g.seterr(1)}}}},FailCode:{nmSubNe:["丸付き数字とその両側の数字の差が一致していません。","The Difference between two Adjacent cells is not equal to the number on circle."],nmIneqNe:["不等号と数字が矛盾しています。","A inequality sign is not correct."]}});